p8105\_hw3\_xs2330
================
Xiao Shi
October 14, 2018

Probelm 1
---------

\*\* Data cleaning \*\*

``` r
brfss = brfss_smart2010 %>%
  janitor::clean_names() %>%
  filter(topic == "Overall Health") %>%
  mutate(response = as.factor(response))
```

\*\* States with 7 locations \*\*

``` r
brfss_2002 = filter(brfss, year == 2002) %>%
  select(locationabbr, locationdesc) %>%
  distinct() %>%
  count(locationabbr)
states_7locs = brfss_2002[which(brfss_2002$n == 7), 1]
states_7locs
```

    ## # A tibble: 3 x 1
    ##   locationabbr
    ##   <chr>       
    ## 1 CT          
    ## 2 FL          
    ## 3 NC

The above three states have 7 observations

\*\* Spaghetti plot of locations \*\*

``` r
brfss_obser = select(brfss, year, locationabbr, locationdesc) %>%
  group_by(year) %>%
  count(locationabbr)
ggplot(brfss_obser, aes(x = year, y = n, color = locationabbr)) +
  geom_line() +
  labs(
    title = "Number of Observations in each state from 2002 to 2010",
    x = "Year",
    y = "Number of Observations",
    caption = "Data from the p8105 package"
  ) +
  viridis::scale_colour_viridis(
    name = "locationabbr", 
    discrete = TRUE
  ) +
  theme_set(theme_bw() + theme(legend.position = "right"))
```

![](p8105_hw3_xs2330_files/figure-markdown_github/p1%20spaghetti%20plot-1.png)

\*\* 2002, 2006, 2010 mean table for "Excellent" responses\*\*

``` r
prop_table_mean = filter(brfss, year == 2002 | year == 2006 | year == 2010) %>%
  filter(locationabbr == "NY") %>%
  filter(response == "Excellent") %>%
  select(year, locationdesc, response, data_value) %>%
  group_by(year) %>%
  summarize(mean_excellent = mean(data_value)) %>% 
  spread(key = year, value = mean_excellent) %>% 
  knitr::kable(digits = 1)
```

\*\* 2002, 2006, 2010 sd table for "Excellent" responses\*\*

``` r
prop_table_sd = filter(brfss, year == 2002 | year == 2006 | year == 2010) %>%
  filter(locationabbr == "NY") %>%
  filter(response == "Excellent") %>%
  select(year, locationdesc, response, data_value) %>%
  group_by(year) %>%
  summarize(sd_excellent = sd(data_value)) %>% 
  spread(key = year, value = sd_excellent) %>% 
  knitr::kable(digits = 1)
```

\*\* Five-panel plot for each response category over time \*\*

``` r
five_panel = select(brfss, year, locationabbr, locationdesc, response, data_value) %>%
  group_by(year, locationabbr, response) %>%
  summarize(respon_mean = mean(data_value))
ggplot(five_panel, aes(x = year, y = respon_mean, color = response)) +
  geom_point() +
  labs(
    title = "Number of Observations in each state from 2002 to 2010",
    x = "Year",
    y = "Number of Observations",
    caption = "Data from the p8105 package"
  ) +
  facet_grid(~response) +
  viridis::scale_colour_viridis(
    name = "response", 
    discrete = TRUE
  ) +
  theme_set(theme_bw() + theme(legend.position = "bottom")) +
  theme(axis.text.x = element_text(angle = 90))
```

![](p8105_hw3_xs2330_files/figure-markdown_github/five%20panel-1.png) The above 5-panel plot shows the average proportion in each response category, and the distribution of these state-level averages over time.

Problem 2
---------

``` r
inscart = instacart
summary(inscart)
```

    ##     order_id         product_id    add_to_cart_order   reordered     
    ##  Min.   :      1   Min.   :    1   Min.   : 1.000    Min.   :0.0000  
    ##  1st Qu.: 843370   1st Qu.:13380   1st Qu.: 3.000    1st Qu.:0.0000  
    ##  Median :1701880   Median :25298   Median : 7.000    Median :1.0000  
    ##  Mean   :1706298   Mean   :25556   Mean   : 8.758    Mean   :0.5986  
    ##  3rd Qu.:2568023   3rd Qu.:37940   3rd Qu.:12.000    3rd Qu.:1.0000  
    ##  Max.   :3421070   Max.   :49688   Max.   :80.000    Max.   :1.0000  
    ##     user_id         eval_set          order_number      order_dow    
    ##  Min.   :     1   Length:1384617     Min.   :  4.00   Min.   :0.000  
    ##  1st Qu.: 51732   Class :character   1st Qu.:  6.00   1st Qu.:1.000  
    ##  Median :102933   Mode  :character   Median : 11.00   Median :3.000  
    ##  Mean   :103113                      Mean   : 17.09   Mean   :2.701  
    ##  3rd Qu.:154959                      3rd Qu.: 21.00   3rd Qu.:5.000  
    ##  Max.   :206209                      Max.   :100.00   Max.   :6.000  
    ##  order_hour_of_day days_since_prior_order product_name      
    ##  Min.   : 0.00     Min.   : 0.00          Length:1384617    
    ##  1st Qu.:10.00     1st Qu.: 7.00          Class :character  
    ##  Median :14.00     Median :15.00          Mode  :character  
    ##  Mean   :13.58     Mean   :17.07                            
    ##  3rd Qu.:17.00     3rd Qu.:30.00                            
    ##  Max.   :23.00     Max.   :30.00                            
    ##     aisle_id     department_id      aisle            department       
    ##  Min.   :  1.0   Min.   : 1.00   Length:1384617     Length:1384617    
    ##  1st Qu.: 31.0   1st Qu.: 4.00   Class :character   Class :character  
    ##  Median : 83.0   Median : 8.00   Mode  :character   Mode  :character  
    ##  Mean   : 71.3   Mean   : 9.84                                        
    ##  3rd Qu.:107.0   3rd Qu.:16.00                                        
    ##  Max.   :134.0   Max.   :21.00

The `instacart` dataset consist of 1384617 rows, and 15 columns. Each row in the dataset is a product from an order. The dataset provided detialed information from the customers' side such as user ID by `user_id`, and the hour of day on which the order was placed by `order_dow`. On the other side, the dataset also provided detialed information from the seller's side such as aisle ID by `aisle_id`, and the aisle name by `aisle`.
